<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8" />
    <title>AR.js Measuring Tape</title>
    <script src="https://aframe.io/releases/1.2.0/aframe.min.js"></script>
    <script src="https://raw.githack.com/AR-js-org/AR.js/master/aframe/build/aframe-ar-nft.js"></script>
</head>

<body style="margin : 0px; overflow: hidden;">
    <a-scene vr-mode-ui="enabled: false;" renderer="logarithmicDepthBuffer: true;" embedded
        arjs="sourceType: webcam; debugUIEnabled: false;">
        <a-nft type="nft" url="markers/hirohiro" smooth="true" smoothCount="10" smoothTolerance=".01"
            smoothThreshold="5">
            <a-entity id="measuringTape" position="0 0 0" rotation="0 0 0" scale="1 1 1"
                obj-model="obj: url(models/measuringTape.obj);" material="color: #ffffff;"></a-entity>
        </a-nft>
        <a-entity camera></a-entity>
        <a-plane id="ground" scale="10 10 10" rotation="-90 0 0" position="0 0 0"
            material="opacity: 0.3; transparent: true; color: #39BB82"></a-plane>
        <a-entity id="measurements" position="-1 1 -1"></a-entity>
        <script>
            // lấy các phần tử HTML
            var canvas = document.getElementById("canvas");
            var measurements = document.getElementById("measurements");

            // tạo một đối tượng ARMarkerControls và gán cho nó biến markerControls
            var markerControls = new THREEx.ArMarkerControls(arToolkitContext, camera, {
                type: "pattern",
                patternUrl: "path/to/pattern-marker.patt",
                changeMatrixMode: "cameraTransformMatrix"
            });

            // xử lý sự kiện update
            markerControls.addEventListener("markerFound", function (e) {
                // lấy kích thước của marker được phát hiện
                var markerWidth = markerControls.getObject3d().children[0].geometry.parameters.width;
                var markerHeight = markerControls.getObject3d().children[0].geometry.parameters.height;

                // tính toán chiều dài, chiều rộng và chiều cao của vật
                var realWidth = markerWidth * (e.detail.transform.matrix.elements[0] / 1000);
                var realHeight = markerHeight * (e.detail.transform.matrix.elements[5] / 1000);
                var realLength = 0.1; // giả sử độ dài của vật là 0.1 mét

                // hiển thị kết quả tính toán trên trang web
                measurements.innerHTML =
                    "Width: " +
                    realWidth.toFixed(2) +
                    "m, Height: " +
                    realHeight.toFixed(2) +
                    "m, Length: " +
                    realLength.toFixed(2) +
                    "m";
            });
        </script>
    </a-scene>
</body>

</html>
